<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <h1><i class="fas fa-tachometer-alt"></i> Panel de Control</h1>
    <p class="text-muted">Sistema de gestión moderno de transportes</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Cargando...</span>
    </div>
    <p>Cargando estadísticas...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="alert alert-danger" role="alert">
    <i class="fas fa-exclamation-triangle"></i> {{ error }}
    <button class="btn btn-sm btn-outline-danger ml-2" (click)="refreshDashboard()">
      <i class="fas fa-redo"></i> Reintentar
    </button>
  </div>

  <!-- Stats Cards - Only show when not loading -->
  <div *ngIf="!isLoading" class="row mb-4">
    <div class="col-md-3 mb-3">
      <div class="stat-card vehicles" (click)="openVehicleModal()" style="cursor: pointer;">
        <div class="stat-icon">
          <i class="fas fa-truck"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.vehicles }}</h3>
          <p>Vehículos</p>
        </div>
        <div class="stat-footer">
          <small class="text-primary">
            <i class="fas fa-plus"></i> Agregar nuevo
          </small>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="stat-card conductors" (click)="openConductorModal()" style="cursor: pointer;">
        <div class="stat-icon">
          <i class="fas fa-user-tie"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.conductors }}</h3>
          <p>Conductores</p>
        </div>
        <div class="stat-footer">
          <small class="text-success">
            <i class="fas fa-plus"></i> Agregar nuevo
          </small>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="stat-card propietarios" (click)="openPropietarioModal()" style="cursor: pointer;">
        <div class="stat-icon">
          <i class="fas fa-user-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.propietarios }}</h3>
          <p>Propietarios</p>
        </div>
        <div class="stat-footer">
          <small class="text-info">
            <i class="fas fa-plus"></i> Agregar nuevo
          </small>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="stat-card reports">
        <div class="stat-icon">
          <i class="fas fa-chart-bar"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.reports }}</h3>
          <p>Reportes</p>
        </div>
        <div class="stat-footer">
          <a [routerLink]="['/reports']" class="text-decoration-none">
            <small class="text-warning">
              <i class="fas fa-arrow-right"></i> Ver todos
            </small>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div *ngIf="!isLoading" class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5><i class="fas fa-bolt"></i> Acciones Rápidas</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <button class="btn btn-primary btn-block" (click)="openVehicleModal()" [disabled]="isModalLoading">
                <i class="fas fa-plus"></i> Nuevo Vehículo
                <span *ngIf="isModalLoading" class="spinner-border spinner-border-sm ml-2"></span>
              </button>
            </div>
            <div class="col-md-6 mb-3">
              <button class="btn btn-success btn-block" (click)="openConductorModal()" [disabled]="isModalLoading">
                <i class="fas fa-plus"></i> Nuevo Conductor
                <span *ngIf="isModalLoading" class="spinner-border spinner-border-sm ml-2"></span>
              </button>
            </div>
            <div class="col-md-6 mb-3">
              <button class="btn btn-info btn-block" (click)="openPropietarioModal()" [disabled]="isModalLoading">
                <i class="fas fa-plus"></i> Nuevo Propietario
                <span *ngIf="isModalLoading" class="spinner-border spinner-border-sm ml-2"></span>
              </button>
            </div>
            <div class="col-md-6 mb-3">
              <button class="btn btn-warning btn-block" [routerLink]="['/reports']">
                <i class="fas fa-chart-line"></i> Ver Reportes
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5><i class="fas fa-clock"></i> Últimas Actividades</h5>
          <button class="btn btn-sm btn-outline-secondary float-right" (click)="refreshDashboard()">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
        <div class="card-body">
          <div class="activity-list">
            <div class="activity-item" *ngFor="let activity of recentActivities">
              <div class="activity-icon" [ngClass]="'activity-' + activity.type">
                <i [ngClass]="activity.icon"></i>
              </div>
              <div class="activity-content">
                <p class="mb-0">{{ activity.description }}</p>
                <small class="text-muted">{{ activity.time }}</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Error Alert -->
  <div *ngIf="modalError" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="fas fa-exclamation-triangle"></i> {{ modalError }}
    <button type="button" class="close" (click)="modalError = null">
      <span>&times;</span>
    </button>
  </div>
</div>

<!-- Modal Backdrop -->
<div *ngIf="isModalLoading" class="modal-backdrop fade show"></div>
